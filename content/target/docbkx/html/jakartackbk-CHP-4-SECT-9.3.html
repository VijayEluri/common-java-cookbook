<html xmlns:fo="http://www.w3.org/1999/XSL/Format">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   
      <title>4.9.3.&nbsp;Discussion</title>
      <link rel="stylesheet" href="../css/html.css" type="text/css">
      <meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
      <link rel="start" href="book.html" title="Jakarta Commons Cookbook">
      <link rel="up" href="jakartackbk-CHP-4-SECT-9.html" title="4.9.&nbsp;Creating Composite Predicates">
      <link rel="prev" href="jakartackbk-CHP-4-SECT-9.2.html" title="4.9.2.&nbsp;Solution">
      <link rel="next" href="jakartackbk-CHP-4-SECT-10.html" title="4.10.&nbsp;Transforming Objects">
   </head>
   <body>
      <div id="frame">
         <div id="forbg">
            <div id="user-header">
               <div id="logo"><a href="http://www.discursive.com" title="$"><img src="../images/discursive-logo.png" border="0"></a></div>
               <div id="right-header">
                  <h2>Common Java Cookbook</h2>
                  <h4>Edition: 0.1-SNAPSHOT</h4>
               </div>
               <div style="clear:both;"></div>
               <div id="left-sidebar"></div>
            </div>
            <div class="navheader">
               <table width="100%" summary="Navigation header">
                  <tr>
                     <td width="40%" align="left"><a accesskey="p" href="jakartackbk-CHP-4-SECT-9.2.html">4.9.2.&nbsp;Solution</a>&nbsp;
                     </td>
                     <td width="20%" align="center"><a accesskey="h" href="book.html">
                           												TOC
                                                                       </a></td>
                     <td width="40%" align="right">&nbsp;<a accesskey="n" href="jakartackbk-CHP-4-SECT-10.html">4.10.&nbsp;Transforming Objects</a></td>
                  </tr>
               </table>
            </div>
            <div class="sect2" lang="en">
               <div class="titlepage">
                  <div>
                     <div>
                        <h3 class="title"><a name="jakartackbk-CHP-4-SECT-9.3"></a>4.9.3.&nbsp;Discussion
                        </h3>
                        <div class="section-icon"></div>
                     </div>
                  </div>
               </div>
               <p>An <code class="literal">AndPredicate</code> returns <code class="literal">true</code> if
                  both predicates supplied to its constructor return
                  <code class="literal">true</code>, and an <code class="literal">OrPredicate</code>
                  returns <code class="literal">true</code> if at least one of the two predicates
                  passed to its constructor returns <code class="literal">true</code>. An
                  <code class="literal">AllPredicate</code> takes an array of predicates, only
                  returning <code class="literal">true</code> if every predicate evaluates to
                  <code class="literal">true</code>. The <code class="literal">OnePredicate</code> also
                  takes an array of predicates, only returning <code class="literal">true</code>
                  if exactly one predicate evaluates to <code class="literal">true</code>.
               </p>
               <p>In the code sample, the use of the second to last predicate,
                  <code class="literal">AllPredicate</code>, is impossible to satisfy; an object
                  can never be a <code class="literal">String</code> and a
                  <code class="literal">Double</code> at the same time. This example fails to
                  demonstrate <code class="literal">AnyPredicate</code> and
                  <code class="literal">NonePredicate</code>&#8212;both take an array of
                  predicates. <code class="literal">AnyPredicate</code> returns
                  <code class="literal">true</code> if any of the predicates evaluate to
                  <code class="literal">true</code>, and <code class="literal">NonePredicate</code> returns
                  <code class="literal">true</code> only if none of the predicates evaluate to
                  <code class="literal">true</code>. The behavior of these objects is easily
                  inferred from the names: And, Or, All, One, Any, or None.
               </p>
               <p>Any logical expression can be modeled by connecting
                  <code class="literal">Predicate</code> objects together&#8212; similar to the
                  way that simple logic gates are connected to create complex digital
                  logic. Logical inputs (1 and 0) are routed to logic gates (AND, OR,
                  NOR, NAND, XOR, etc.), and the outputs of a logic circuit are a
                  result of stages that perform the same function as the
                  <code class="literal">Predicate</code> objects introduced in this recipe. In
                  the next example, a logic circuit will be used to demonstrate a
                  complex hierarchy of <code class="literal">Predicate</code> objects; a circuit
                  diagram is drawn, and a series of predicates are developed to model
                  this circuit. <a href="jakartackbk-CHP-4-SECT-9.3.html#jakartackbk-CHP-4-FIG-1" title="Figure&nbsp;4-1.&nbsp;Logical expression to be modeled with Predicate">Figure 4-1</a> contains a logical
                  expression that is implemented with digital logic and
                  <code class="literal">Predicate</code> objects.
               </p>
               <div class="figure"><a name="jakartackbk-CHP-4-FIG-1"></a><div class="figure-contents">
                     <div class="mediaobject"><a name="I_4_tt179"></a><img src="figs/web/jccb_0401.png" alt="Logical expression to be modeled with Predicate"></div>
                  </div>
                  <p class="title"><b>Figure&nbsp;4-1.&nbsp;Logical expression
                        
                         to be modeled with Predicate</b></p>
               </div><br class="figure-break"><p>Assuming that every letter corresponds to a
                  <code class="literal">boolean</code> variable, this expression corresponds to
                  the circuit diagram in <a href="jakartackbk-CHP-4-SECT-9.3.html#jakartackbk-CHP-4-FIG-2" title="Figure&nbsp;4-2.&nbsp;Circuit representing logical expression">Figure 4-2</a>. Each gate can be
                  modeled as a composite <code class="literal">Predicate</code>, and from <a href="jakartackbk-CHP-4-SECT-9.3.html#jakartackbk-CHP-4-FIG-2" title="Figure&nbsp;4-2.&nbsp;Circuit representing logical expression">Figure 4-2</a> it is clear that this example will include two
                  <code class="literal">AndPredicates</code>, an <code class="literal">OrPredicate</code>,
                  and a <code class="literal">NotPredicate</code>. The
                  "AND" gate is modeled with an
                  <code class="literal">AndPredicate</code>, and an
                  "OR" gate with an
                  <code class="literal">OrPredicate</code>. The
                  "NAND" gate is transformed into a
                  three-input "AND" gate followed by
                  an inverter that is modeled with an <code class="literal">AllPredicate</code>
                  wrapped in a <code class="literal">NotPredicate</code>.
               </p>
               <div class="figure"><a name="jakartackbk-CHP-4-FIG-2"></a><div class="figure-contents">
                     <div class="mediaobject"><a name="I_4_tt180"></a><img src="figs/web/jccb_0402.png" alt="Circuit representing logical expression"></div>
                  </div>
                  <p class="title"><b>Figure&nbsp;4-2.&nbsp;Circuit representing logical expression</b></p>
               </div><br class="figure-break"><p>The system has five inputs, which will be stored in a
                  <code class="literal">Map</code> with five keys: A, B, C, D, and E. A simple
                  <code class="literal">InputPredicate</code> is developed to handle the inputs
                  to the system&#8212;a map of <code class="literal">Boolean</code> input objects
                  is passed to the top-level <code class="literal">Predicate</code>. An
                  <code class="literal">InputPredicate</code> is configured to evaluate the input
                  <code class="literal">Map</code> and return the <code class="literal">boolean</code>
                  value of one of the inputs; in other words, an
                  <code class="literal">InputPredicate</code>
                                 <a class="indexterm" name="jakartackbk-CHP-4-ITERM-2362"></a>
                  selects a <code class="literal">boolean</code> value from a
                  <code class="literal">Map</code>, always returning the value of that input from
                  the <code class="literal">Map</code> it evaluates. (See <a href="jakartackbk-CHP-4-SECT-9.3.html#jakartackbk-CHP-4-EX-7" title="Example&nbsp;4-7.&nbsp;InputPredicate: a predicate that selects an input from a Map">Example 4-7</a>.)
               </p>
               <div class="example"><a name="jakartackbk-CHP-4-EX-7"></a><p class="title"><b>Example&nbsp;4-7.&nbsp;InputPredicate: a predicate that selects an input from a Map</b></p>
                  <div class="example-contents"><a class="indexterm" name="jakartackbk-CHP-4-ITERM-2363"></a><pre class="programlisting">package com.discursive.jccook.collections.predicate;

import org.apache.commons.collections.Predicate;

public class InputPredicate implements Predicate {

    private String inputKey;

    public BooleanPredicate(String inputKey) {
        this.inputKey = inputKey;
    }

    public boolean evaluate(Object object) {
        boolean satisfies = false;

            Map inputMap = (Map) object;
        Boolean input = (Boolean) inputMap.get( inputKey );
        if( input != null ) {
            satisfies = input.booleanValue( );
        }

        return satisfies;
    }
}</pre></div>
               </div><br class="example-break"><p>The entire circuit is modeled by one top-level
                  <code class="literal">Predicate</code> and a <code class="literal">Map</code> of
                  <code class="literal">Boolean</code> input signals is passed down a hierarchy
                  of predicates as needed. Unlike a real circuit, where inputs would
                  cause gates to fire sequentially, the predicate hierarchy is
                  evaluated from the final stage backward&#8212;the example evaluates
                  the <code class="literal">Predicate</code> variable <code class="literal">circuit</code>.
                  The input map is passed to the top-most <code class="literal">Predicate</code>,
                  which, in turn, passes this same map to the
                  <code class="literal">Predicate</code> that precedes it in
                  <a class="indexterm" name="jakartackbk-CHP-4-ITERM-2364"></a>the circuit. <a href="jakartackbk-CHP-4-SECT-9.3.html#jakartackbk-CHP-4-EX-8" title="Example&nbsp;4-8.&nbsp;Implementing a multilevel composite Predicate">Example 4-8</a> ties everything together, and the logic to
                  create our circuit-modeling predicate has been confined to the
                  <code class="literal">createPredicate()</code>
                                 <a class="indexterm" name="jakartackbk-CHP-4-ITERM-2365"></a>
                                 <a class="indexterm" name="jakartackbk-CHP-4-ITERM-2366"></a> method.
               </p>
               <div class="example"><a name="jakartackbk-CHP-4-EX-8"></a><p class="title"><b>Example&nbsp;4-8.&nbsp;Implementing a 
                        multilevel composite Predicate</b></p>
                  <div class="example-contents"><a class="indexterm" name="jakartackbk-CHP-4-ITERM-2367"></a><a class="indexterm" name="jakartackbk-CHP-4-ITERM-2368"></a><pre class="programlisting">package com.discursive.jccook.collections.predicate;

import org.apache.commons.collections.Predicate;
import org.apache.commons.collections.functors.*;

public class CompoundPredicateExample {

    public static void main(String[] args) {
        CompoundPredicateExample example = new CompoundPredicateExample( );
        example.start( );
    }

    public void start( ) {

<strong class="userinput"><code>        Predicate circuit = createPredicate( );</code></strong>
                  <strong class="userinput"><code>       Object[] inputsArray = </code></strong>
                  <strong class="userinput"><code>           new Object[][] { {"A", Boolean.TRUE},</code></strong>
                  <strong class="userinput"><code>                            {"B", Boolean.FALSE},</code></strong>
                  <strong class="userinput"><code>                            {"C", Boolean.TRUE},</code></strong>
                  <strong class="userinput"><code>                            {"D", Boolean.FALSE},</code></strong>
                  <strong class="userinput"><code>                            {"E", Boolean.FALSE} };</code></strong>
                  <strong class="userinput"><code>        Map inputs = ArrayUtils.toMap( inputsArray );</code></strong>
                  <strong class="userinput"><code>        boolean result = circuit.evaluate( inputs ); </code></strong>

                  <strong class="userinput"><code>         System.out.println( "The circuit fired?: " + result );</code></strong>
                  <strong class="userinput"><code>    }</code></strong>

    public Predicate createPredicate( ) {
        Predicate aPredicate = new InputPredicate("A");
        Predicate bPredicate = new InputPredicate("B");
        Predicate cPredicate = new InputPredicate("C");
        Predicate dPredicate = new InputPredicate("D");
        Predicate ePredicate = new InputPredicate("E");

        Predicate expression1 = new AndPredicate( aPredicate, bPredicate );
        Predicate expression2 = new OrPredicate( cPredicate, dPredicate );

       Predicate[] secondLevel = 
           new Predicate( ) { expression1, expression2, ePredicate };

       Predicate topLevel = new NotPredicate( secondLevel );
       return topLevel;
    }
}</pre></div>
               </div><br class="example-break"><p>This code prints <code class="literal">The</code> 
                                 <code class="literal">circuit</code>
                                 <code class="literal">fired?</code>: <code class="literal">true</code>. This complex
                  example has demonstrated the process of modeling composite,
                  multistage logic with a hierarchy of predicates. A
                  <code class="literal">Predicate</code> is the most basic functor and when
                  combined with other <code class="literal">Predicate</code> instances, there is
                  no limit to the level of complexity that can be achieved. Logic
                  circuits were used in this example because a logic gate is <a class="indexterm" name="jakartackbk-CHP-4-ITERM-2369"></a> 
                                 <a class="indexterm" name="jakartackbk-CHP-4-ITERM-2370"></a> 
                                 <a class="indexterm" name="jakartackbk-CHP-4-ITERM-2371"></a> 
                                 <a class="indexterm" name="jakartackbk-CHP-4-ITERM-2372"></a> 
                                 <a class="indexterm" name="jakartackbk-CHP-4-ITERM-2373"></a> 
                                 <a class="indexterm" name="jakartackbk-CHP-4-ITERM-2374"></a>a great analogy
                  for a <code class="literal">Predicate</code>. Think of a
                  <code class="literal">Predicate</code> as a component&#8212;a gate in a logic
                  circuit.
               </p>
            </div>
            <div class="navfooter">
               <hr>
               <table width="100%" summary="Navigation footer">
                  <tr>
                     <td width="40%" align="left"><a accesskey="p" href="jakartackbk-CHP-4-SECT-9.2.html">Prev</a>&nbsp;
                     </td>
                     <td width="20%" align="center"><a accesskey="h" href="book.html">Home</a></td>
                     <td width="40%" align="right">&nbsp;<a accesskey="n" href="jakartackbk-CHP-4-SECT-10.html">Next</a></td>
                  </tr>
                  <tr>
                     <td width="40%" align="left" valign="top">4.9.2.&nbsp;Solution&nbsp;</td>
                     <td width="20%" align="center"><span style="color:white;font-size:90%;"><a href="http://www.sonatype.com/" title="Discursive: Discursive">Sponsored by Discursive
                                                                      </a></span></td>
                     <td width="40%" align="right" valign="top">&nbsp;4.10.&nbsp;Transforming Objects</td>
                  </tr>
               </table>
            </div><br><center>
                             Copyright 2009. Discursive. All Rights Reserved.
                           
            </center><script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1693297-1");
pageTracker._initData();
pageTracker._setDomainName(".sonatype.com");
pageTracker._trackPageview();
</script><script src="http://loopfuse.net/webrecorder/js/listen.js" type="text/javascript"></script><script type="text/javascript">
  _lf_cid = "LF_5208d25a";
_lf_remora();
</script></div>
      </div>
   </body>
</html>