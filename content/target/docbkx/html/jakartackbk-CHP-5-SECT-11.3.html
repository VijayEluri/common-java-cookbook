<html xmlns:fo="http://www.w3.org/1999/XSL/Format">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   
      <title>5.11.3.&nbsp;Discussion</title>
      <link rel="stylesheet" href="../css/html.css" type="text/css">
      <meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
      <link rel="start" href="book.html" title="Jakarta Commons Cookbook">
      <link rel="up" href="jakartackbk-CHP-5-SECT-11.html" title="5.11.&nbsp;Retrieving a Key by a Value">
      <link rel="prev" href="jakartackbk-CHP-5-SECT-11.2.html" title="5.11.2.&nbsp;Solution">
      <link rel="next" href="jakartackbk-CHP-5-SECT-11.4.html" title="5.11.4.&nbsp;See Also">
   </head>
   <body>
      <div id="frame">
         <div id="forbg">
            <div id="user-header">
               <div id="logo"><a href="http://www.discursive.com" title="$"><img src="../images/discursive-logo.png" border="0"></a></div>
               <div id="right-header">
                  <h2>Common Java Cookbook</h2>
                  <h4>Edition: 0.1-SNAPSHOT</h4>
               </div>
               <div style="clear:both;"></div>
               <div id="left-sidebar"></div>
            </div>
            <div class="navheader">
               <table width="100%" summary="Navigation header">
                  <tr>
                     <td width="40%" align="left"><a accesskey="p" href="jakartackbk-CHP-5-SECT-11.2.html">5.11.2.&nbsp;Solution</a>&nbsp;
                     </td>
                     <td width="20%" align="center"><a accesskey="h" href="book.html">
                           												TOC
                                                                       </a></td>
                     <td width="40%" align="right">&nbsp;<a accesskey="n" href="jakartackbk-CHP-5-SECT-11.4.html">5.11.4.&nbsp;See Also</a></td>
                  </tr>
               </table>
            </div>
            <div class="sect2" lang="en">
               <div class="titlepage">
                  <div>
                     <div>
                        <h3 class="title"><a name="jakartackbk-CHP-5-SECT-11.3"></a>5.11.3.&nbsp;Discussion
                        </h3>
                        <div class="section-icon"></div>
                     </div>
                  </div>
               </div>
               <p>In <a href="jakartackbk-CHP-5-SECT-11.3.html#jakartackbk-CHP-5-EX-11" title="Example&nbsp;5-11.&nbsp;Storing ISO country codes in a BidiMap">Example 5-11</a>, a <code class="literal">BidiMap</code> is used
                  to store country names and country codes; an application stores ISO
                  country codes and translates between ISO country codes and country
                  names to present intelligible
                  output&#8212;"us" is translated to
                  "United States." Alternatively,
                  when a user types in a name of a country, the application needs to be
                  able to produce the country code for that country
                  name&#8212;"United States" must be
                  translated back to "us."
               </p>
               <div class="example"><a name="jakartackbk-CHP-5-EX-11"></a><p class="title"><b>Example&nbsp;5-11.&nbsp;Storing ISO country codes in a BidiMap</b></p>
                  <div class="example-contents"><pre class="programlisting">package com.discursive.jccook.collections.bidi;

import org.apache.commons.collections.BidiMap;
import org.apache.commons.collections.bidimap.DualHashBidiMap;

public class BidiMapExample {

    private BidiMap countryCodes = new DualHashBidiMap( );

    public static void main(String[] args) {
        BidiMapExample example = new BidiMapExample( );
        example.start( );
    }
    
    private void start( ) {
        populateCountryCodes( );
        
        String countryName = (String) countryCodes.get( "tr" );
        System.out.println( "Country Name for code 'tr': " + countryName );

        String countryCode = 
            (String) countryCodes.inverseBidiMap( ).get("Uruguay");
        System.out.println( "Country Code for name 'Uruguay': " + countryCode );
            
        countryCode = (String) countryCodes.getKey("Ukraine");
        System.out.println( "Country Code for name 'Ukraine': " + countryCode );
    }
    
    private void populateCountryCodes( ) {
        countryCodes.put("to","Tonga");
        countryCodes.put("tr","Turkey");
        countryCodes.put("tv","Tuvalu");
        countryCodes.put("tz","Tanzania");
        countryCodes.put("ua","Ukraine");
        countryCodes.put("ug","Uganda");
        countryCodes.put("uk","United Kingdom");
        countryCodes.put("um","USA Minor Outlying Islands");
        countryCodes.put("us","United States");
        countryCodes.put("uy","Uruguay");
    }
}</pre></div>
               </div><br class="example-break"><p>The previous example makes sense because country codes and country
                  names are both unique; there is only one entry for
                  "Djibouti,"
                  "dj,"and no other country has an
                  overlapping code because country codes are defined by an
                  International Organization for Standardization (ISO) standard, ISO
                  3166. If you attempt to insert a duplicate key in a regular map, the
                  existing entry with the same key would be replaced by the new value.
                  In a <code class="literal">BidiMap</code>, if you insert a duplicate value, or
                  a <span class="emphasis"><em>duplicate key</em></span>, the entry holding this value is
                  replaced by a new entry. The following example illustrates this
                  concept:
               </p><a name="I_5_tt232"></a><pre class="programlisting">private BidiMap bidiMap = new DualHashBidiMap( );

// Insert initial content { "one:"red", "two":"green", "three":"blue" }
bidiMap.put("one","red");
bidiMap.put("two","green");
bidiMap.put("three","blue");

// replace "one" key entry
bidiMap.put("one","black");

// replace "green" value entry
bidiMap.put("five","green");

// Contents are now { "one":"black", "three":"blue", "five":"green" }</pre><p>Changing key "one," value
                  "black" replaces the original key
                  "one," value
                  "red" because the key is
                  duplicated; this behavior is consistent with a normal implementation
                  of <code class="literal">Map</code>. The difference in a
                  <code class="literal">BidiMap</code> is that when adding key
                  "five," value
                  "green" to a
                  <code class="literal">BidiMap</code>, the previous key
                  "two," value
                  "green" is replaced with a new
                  entry because "green" is a
                  duplicate value. A regular <code class="literal">Map</code> simply adds another
                  entry, and getting the value of either the
                  "five," or
                  "two," key would return the value
                  "green." Because
                  "green" already occurs as a key in
                  the inverse map, the entry corresponding to the
                  "two," key is removed and replaced
                  by a new entry. Bidirectional access to keys by value is only
                  possible if keys and values form two unique sets.
               </p>
               <p>There are three implementations of the <code class="literal">BidiMap</code>
                  interface: <code class="literal">DualHashBidiMap</code>,
                  <code class="literal">DialTreeBidiMap</code>, and
                  <code class="literal">TreeBidiMap</code>. A <code class="literal">DualHashBidiMap</code>
                  is the simplest option, storing keys and values in two separate
                  instances of <code class="literal">HashMap</code>. When a value is requested by
                  key, one
                  <code class="literal">HashMap</code>
                                 <a class="indexterm" name="jakartackbk-CHP-5-ITERM-2561"></a>
                  is consulted, and when a key is requested by value, the inverse
                  <code class="literal">HashMap</code> is consulted. The
                  <code class="literal">DualHashMap</code> is likely to be your implementation of
                  choice if it is not important to keep track of the insertion order;
                  it has a straightforward implementation using the familiar
                  <code class="literal">HashMap</code>.
               </p>
               <p>If you need to preserve the order of <a class="indexterm" name="jakartackbk-CHP-5-ITERM-2562"></a>insertion, a
                  <code class="literal">DualTreeBidiMap</code> uses two separate
                  <code class="literal">TreeMap</code> instances to hold the regular and inverse
                  mappings. This implementation implements the
                  <code class="literal">SortedMap</code> interface that keeps track of the order
                  of insertion and provides <code class="literal">subMap( )</code>,
                  <code class="literal">headMap( )</code>, and <code class="literal">tailMap( )</code>
                  methods. A third implementation, <code class="literal">TreeBidiMap</code>,
                  implements <code class="literal">BidiMap</code> without maintaining two
                  internal storage maps. Instead, <code class="literal">TreeBidiMap</code> stores
                  nodes in a red-black tree, identifying each node as both a key and a
                  value; it costs twice as much to <code class="literal">put( )</code> into a
                  <code class="literal">TreeBidiMap</code>, but this implementation comes in
                  handy if you are worried about memory consumption&#8212;it does not
                  need to store each key and value twice in two maps.
               </p>
            </div>
            <div class="navfooter">
               <hr>
               <table width="100%" summary="Navigation footer">
                  <tr>
                     <td width="40%" align="left"><a accesskey="p" href="jakartackbk-CHP-5-SECT-11.2.html">Prev</a>&nbsp;
                     </td>
                     <td width="20%" align="center"><a accesskey="h" href="book.html">Home</a></td>
                     <td width="40%" align="right">&nbsp;<a accesskey="n" href="jakartackbk-CHP-5-SECT-11.4.html">Next</a></td>
                  </tr>
                  <tr>
                     <td width="40%" align="left" valign="top">5.11.2.&nbsp;Solution&nbsp;</td>
                     <td width="20%" align="center"><span style="color:white;font-size:90%;"><a href="http://www.sonatype.com/" title="Discursive: Discursive">Sponsored by Discursive
                                                                      </a></span></td>
                     <td width="40%" align="right" valign="top">&nbsp;5.11.4.&nbsp;See Also</td>
                  </tr>
               </table>
            </div><br><center>
                             Copyright 2009. Discursive. All Rights Reserved.
                           
            </center><script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1693297-1");
pageTracker._initData();
pageTracker._setDomainName(".sonatype.com");
pageTracker._trackPageview();
</script><script src="http://loopfuse.net/webrecorder/js/listen.js" type="text/javascript"></script><script type="text/javascript">
  _lf_cid = "LF_5208d25a";
_lf_remora();
</script></div>
      </div>
   </body>
</html>