<html xmlns:fo="http://www.w3.org/1999/XSL/Format">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   
      <title>1.18.3.&nbsp;Discussion</title>
      <link rel="stylesheet" href="../css/html.css" type="text/css">
      <meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
      <link rel="start" href="book.html" title="Jakarta Commons Cookbook">
      <link rel="up" href="jakartackbk-CHP-1-SECT-18.html" title="1.18.&nbsp;Validation of Method Parameters">
      <link rel="prev" href="jakartackbk-CHP-1-SECT-18.2.html" title="1.18.2.&nbsp;Solution">
      <link rel="next" href="jakartackbk-CHP-1-SECT-18.4.html" title="1.18.4.&nbsp;See Also">
   </head>
   <body>
      <div id="frame">
         <div id="forbg">
            <div id="user-header">
               <div id="logo"><a href="http://www.discursive.com" title="$"><img src="../images/discursive-logo.png" border="0"></a></div>
               <div id="right-header">
                  <h2>Common Java Cookbook</h2>
                  <h4>Edition: 0.1-SNAPSHOT</h4>
               </div>
               <div style="clear:both;"></div>
               <div id="left-sidebar"></div>
            </div>
            <div class="navheader">
               <table width="100%" summary="Navigation header">
                  <tr>
                     <td width="40%" align="left"><a accesskey="p" href="jakartackbk-CHP-1-SECT-18.2.html">1.18.2.&nbsp;Solution</a>&nbsp;
                     </td>
                     <td width="20%" align="center"><a accesskey="h" href="book.html">
                           												TOC
                                                                       </a></td>
                     <td width="40%" align="right">&nbsp;<a accesskey="n" href="jakartackbk-CHP-1-SECT-18.4.html">1.18.4.&nbsp;See Also</a></td>
                  </tr>
               </table>
            </div>
            <div class="sect2" lang="en">
               <div class="titlepage">
                  <div>
                     <div>
                        <h3 class="title"><a name="jakartackbk-CHP-1-SECT-18.3"></a>1.18.3.&nbsp;Discussion
                        </h3>
                        <div class="section-icon"></div>
                     </div>
                  </div>
               </div>
               <p>Write finicky methods. Don't just work with any
                  input, have some standards. Don't hang around with
                  garbage or <code class="literal">null</code>s&#8212;clean up your act, and use
                  <code class="literal">Validate</code>. Methods in <code class="literal">Validate</code>
                  throw an <code class="literal">IllegalArgumentException</code> if invalid
                  parameters are encountered. <code class="literal">Validate.notEmpty( )</code>
                  will throw an exception if the parameter is <code class="literal">null</code>
                  or empty, and <code class="literal">Validate.isTrue( )</code> takes a logical
                  expression that must evaluate to true. <a href="jakartackbk-CHP-1-SECT-18.3.html#jakartackbk-CHP-1-TABLE-5" title="Table&nbsp;1-5.&nbsp;Available static methods on Validate">Table 1-5</a>
                  lists a number of static methods of <code class="literal">Validate</code>.
               </p>
               <div class="table"><a name="jakartackbk-CHP-1-TABLE-5"></a><p class="title"><b>Table&nbsp;1-5.&nbsp;Available static methods on Validate</b></p>
                  <div class="table-contents">
                     <table summary="Available static methods on Validate" border="1">
                        <colgroup>
                           <col>
                           <col>
                        </colgroup>
                        <thead>
                           <tr>
                              <th>
                                                            
                                 <p>Validate method</p>
                                                         
                              </th>
                              <th>
                                                            
                                 <p>Description</p>
                                                         
                              </th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td>
                                                            
                                 <p>
                                                                  <code class="literal">isTrue(boolean expr)</code>
                                                               
                                 </p>
                                                         
                              </td>
                              <td>
                                                            
                                 <p>Fails if expression evaluates to false</p>
                                                         
                              </td>
                           </tr>
                           <tr>
                              <td>
                                                            
                                 <p>
                                                                  <code class="literal">isTrue(boolean expr, String msg)</code>
                                                               
                                 </p>
                                                         
                              </td>
                              <td>
                                                            
                                 <p>Same as above; constructs exception with a message</p>
                                                         
                              </td>
                           </tr>
                           <tr>
                              <td>
                                                            
                                 <p>
                                                                  <code class="literal">noNullElements(Collection col)</code>
                                                               
                                 </p>
                                                         
                              </td>
                              <td>
                                                            
                                 <p>Fails if collection contains a null</p>
                                                         
                              </td>
                           </tr>
                           <tr>
                              <td>
                                                            
                                 <p>
                                                                  <code class="literal">noNullElements(Object[] array)</code>
                                                               
                                 </p>
                                                         
                              </td>
                              <td>
                                                            
                                 <p>Fails if array contains a null</p>
                                                         
                              </td>
                           </tr>
                           <tr>
                              <td>
                                                            
                                 <p>
                                                                  <code class="literal">notEmpty(Collection col)</code>
                                                               
                                 </p>
                                                         
                              </td>
                              <td>
                                                            
                                 <p>Fails if collection is empty</p>
                                                         
                              </td>
                           </tr>
                           <tr>
                              <td>
                                                            
                                 <p>
                                                                  <code class="literal">notEmpty(Map map)</code>
                                                               
                                 </p>
                                                         
                              </td>
                              <td>
                                                            
                                 <p>Fails if map is empty</p>
                                                         
                              </td>
                           </tr>
                           <tr>
                              <td>
                                                            
                                 <p>
                                                                  <code class="literal">notEmpty(Object[] array)</code>
                                                               
                                 </p>
                                                         
                              </td>
                              <td>
                                                            
                                 <p>Fails if array is empty</p>
                                                         
                              </td>
                           </tr>
                           <tr>
                              <td>
                                                            
                                 <p>
                                                                  <code class="literal">notNull(Object obj)</code>
                                                               
                                 </p>
                                                         
                              </td>
                              <td>
                                                            
                                 <p>Fails if object is null</p>
                                                         
                              </td>
                           </tr>
                        </tbody>
                     </table>
                  </div>
               </div><br class="table-break"><p>Well-written code tests input and parameters. Is the number within a
                  given range? Has the user supplied an index that is out of bounds for
                  this array? Unless you want your applications to break down and throw
                  exceptions, make sure that you are not trying to access the 15th
                  element of a 10-element array; your code should be skeptical of
                  parameters and refuse to run if it doesn't get its
                  way. In fragile systems, parameter validation is not a top priority;
                  errors are dealt with as different application layers throw a
                  potpourri of exceptions. Other, more unstable, systems will pass a
                  <code class="literal">null</code> all the way down the call stack until the
                  lowest level blows up and spits back a
                  <code class="literal">NullPointerException</code>&#8212;with a long-winded
                  stack trace. Don't play around with
                  <code class="literal">null</code>&#8212;avoid it, test your system
                  exhaustively, and throw an
                  <code class="literal">IllegalArgumentException</code>.
               </p>
               <p>Consider the following method, which takes a latitude, longitude, and
                  mode parameter. Both the latitude and longitude must fall within a
                  valid range, and this method should throw an
                  <code class="literal">IllegalArgumentException</code> if it encounters an
                  unrealistic latitude, an unrealistic longitude, or an empty mode
                  parameter. The <code class="literal">Validate</code> utility used in
                  conjunction with a <code class="literal">DoubleRange</code> object can reduce
                  the amount of code dedicated to range checking and method parameter
                  validation. To test the validity of the coordinates, two constant
                  <code class="literal">DoubleRange</code> objects are created outside of the
                  method. <code class="literal">DoubleRange.includesDouble(double</code>
                                 <code class="literal">d)</code> returns true if the number falls within the
                  defined range&#8212;<code class="literal">if x &lt;= rangeMax &amp;&amp; x &gt;=
                     rangeMin</code>. (See <a href="jakartackbk-CHP-1-SECT-18.3.html#jakartackbk-CHP-1-EX-19" title="Example&nbsp;1-19.&nbsp;Using the Validator and the DoubleRange to validate method parameters">Example 1-19</a>.)
               </p>
               <div class="example"><a name="jakartackbk-CHP-1-EX-19"></a><p class="title"><b>Example&nbsp;1-19.&nbsp;Using the Validator and the DoubleRange to validate method parameters</b></p>
                  <div class="example-contents"><pre class="programlisting">public static final DoubleRange LAT_RANGE = new DoubleRange(  -90.0,  90.0 );
public static final DoubleRange LON_RANGE = new DoubleRange( -180.0, 180.0 );

public double elevation( double latitude, 
                         double longitude,
                         String mode ) {
    Validate.notEmpty( mode, "Mode cannot be empty or null" );
    Validate.isTrue( LAT_RANGE.includesDouble( latitude ),
                      "Lat not in range " + latRange, latitude );
    Validate.isTrue( LON_RANGE.includesDouble( longitude ),
                      "Lon not in range " + lonRange, longitude );

    double elevation = 0.0;
    // code to implement the elevation method
    return elevation;
}</pre></div>
               </div><br class="example-break"><p>It takes a fair amount of institutional discipline to make sure that
                  a code base has a sufficient amount of validation, and it is
                  surprising how often systems scale to thousands of lines without it.
                  Systems without good internal validation and sanity checks are
                  characterized by frequent occurrences of
                  <code class="literal">NullPointerException</code> and
                  <code class="literal">RuntimeException</code>. Throwing
                  <code class="literal">RuntimeException</code> in the form of
                  <code class="literal">IllegalArgumentException</code> might seem like an odd
                  recipe for increasing overall stability. But, if you actively throw
                  exceptions and test exhaustively, it will be less toil and trouble to
                  identify and fix defects&#8212;your application will fail sooner, and
                  you will have short stack traces and well-defined problems.
                  Performing rigorous parameter validation alone will not create a
                  stable system, but it is part of a larger equation, which involves
                  unit testing and validation.
               </p>
               <p>In addition to parameter validation, you should be writing unit tests
                  that test this validation. If you write good unit tests using JUnit
                  and then measure your test coverage with a tool like Clover or
                  JCoverage, you can save yourself an amazing amount of grief fixing
                  unanticipated defects. Your unit tests should be covering close to
                  100% of your code, and they should throw curveballs.
                  Don't just test the expected situation&#8212;if your
                  method takes a double, see what it does with
                  <code class="literal">Double.POSITIVE_INFINITY</code>; and if your method takes
                  an array, pass it a <code class="literal">null</code>. Test the unexpected; if
                  you find that your method melts down with a <code class="literal">null</code>,
                  check the parameter with <code class="literal">Validate</code>. 100% test
                  coverage is not an unrealistic ideal; it will drive your validation
                  code. More test coverage always leads to a higher level of system
                  quality.
               </p>
            </div>
            <div class="navfooter">
               <hr>
               <table width="100%" summary="Navigation footer">
                  <tr>
                     <td width="40%" align="left"><a accesskey="p" href="jakartackbk-CHP-1-SECT-18.2.html">Prev</a>&nbsp;
                     </td>
                     <td width="20%" align="center"><a accesskey="h" href="book.html">Home</a></td>
                     <td width="40%" align="right">&nbsp;<a accesskey="n" href="jakartackbk-CHP-1-SECT-18.4.html">Next</a></td>
                  </tr>
                  <tr>
                     <td width="40%" align="left" valign="top">1.18.2.&nbsp;Solution&nbsp;</td>
                     <td width="20%" align="center"><span style="color:white;font-size:90%;"><a href="http://www.sonatype.com/" title="Discursive: Discursive">Sponsored by Discursive
                                                                      </a></span></td>
                     <td width="40%" align="right" valign="top">&nbsp;1.18.4.&nbsp;See Also</td>
                  </tr>
               </table>
            </div><br><center>
                             Copyright 2009. Discursive. All Rights Reserved.
                           
            </center><script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1693297-1");
pageTracker._initData();
pageTracker._setDomainName(".sonatype.com");
pageTracker._trackPageview();
</script><script src="http://loopfuse.net/webrecorder/js/listen.js" type="text/javascript"></script><script type="text/javascript">
  _lf_cid = "LF_5208d25a";
_lf_remora();
</script></div>
      </div>
   </body>
</html>