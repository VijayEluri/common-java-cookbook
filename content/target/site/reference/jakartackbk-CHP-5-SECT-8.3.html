<html xmlns:fo="http://www.w3.org/1999/XSL/Format">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   
      <title>5.8.3.&nbsp;Discussion</title>
      <link rel="stylesheet" href="../css/html.css" type="text/css">
      <meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
      <link rel="start" href="book.html" title="Jakarta Commons Cookbook">
      <link rel="up" href="jakartackbk-CHP-5-SECT-8.html" title="5.8.&nbsp;Creating a Priority Queue">
      <link rel="prev" href="jakartackbk-CHP-5-SECT-8.2.html" title="5.8.2.&nbsp;Solution">
      <link rel="next" href="jakartackbk-CHP-5-SECT-8.4.html" title="5.8.4.&nbsp;See Also">
   </head>
   <body>
      <div id="frame">
         <div id="forbg">
            <div id="user-header">
               <div id="logo"><a href="http://www.discursive.com" title="$"><img src="../images/discursive-logo.png" border="0"></a></div>
               <div id="right-header">
                  <h2>Common Java Cookbook</h2>
                  <h4>Edition: 0.1-SNAPSHOT</h4>
               </div>
               <div style="clear:both;"></div>
               <div id="left-sidebar"></div>
            </div>
            <div class="navheader">
               <table width="100%" summary="Navigation header">
                  <tr>
                     <td width="40%" align="left"><a accesskey="p" href="jakartackbk-CHP-5-SECT-8.2.html">5.8.2.&nbsp;Solution</a>&nbsp;
                     </td>
                     <td width="20%" align="center"><a accesskey="h" href="book.html">
                           												TOC
                                                                       </a></td>
                     <td width="40%" align="right">&nbsp;<a accesskey="n" href="jakartackbk-CHP-5-SECT-8.4.html">5.8.4.&nbsp;See Also</a></td>
                  </tr>
               </table>
            </div>
            <div class="sect2" lang="en">
               <div class="titlepage">
                  <div>
                     <div>
                        <h3 class="title"><a name="jakartackbk-CHP-5-SECT-8.3"></a>5.8.3.&nbsp;Discussion
                        </h3>
                        <div class="section-icon"></div>
                     </div>
                  </div>
               </div>
               <p>A <code class="literal">PriorityBuffer</code>, like all
                  <code class="literal">Buffer</code> implementations, is defined by the logic to
                  select which object to remove. If you've ever
                  visited an emergency room, you are already familiar with the inner
                  workings of the <code class="literal">PriorityBuffer</code>. When a patient
                  enters the emergency room, his or her condition is evaluated by a
                  nurse who then assigns a severity. When a doctor moves to the next
                  patient, she chooses the next patient based on severity and how long
                  each patient has been waiting. A patient with a critical,
                  life-threatening condition will be treated before an individual with
                  a headache&#8212;the critical patient has a higher priority in the
                  <code class="literal">Buffer</code>.
               </p>
               <p>The following example models an emergency waiting room with a
                  <code class="literal">PriorityBuffer</code>. Assume that you have a
                  <code class="literal">Patient</code> bean with <code class="literal">name</code>,
                  <code class="literal">severity</code>, and <code class="literal">checkIn</code>
                  properties, which is defined in <a href="jakartackbk-CHP-5-SECT-8.3.html#jakartackbk-CHP-5-EX-5" title="Example&nbsp;5-5.&nbsp;A Patient object">Example 5-5</a>. A
                  patient's severity is a number from 0 to 10, 0 being
                  the lowest severity and 10 being the highest. A critical patient
                  would be assigned a priority of 10, and a patient with a bad cold
                  would be assigned a severity of 0. A patient also has a
                  <code class="literal">checkIn</code> time: this is the time he is admitted to
                  the waiting room, and it is used as a tie-breaker to determine
                  priority when two patients have the same <code class="literal">severity</code>.
               </p>
               <div class="example"><a name="jakartackbk-CHP-5-EX-5"></a><p class="title"><b>Example&nbsp;5-5.&nbsp;A Patient object</b></p>
                  <div class="example-contents"><pre class="programlisting">package com.discursive.jccook.collections.buffers;

public class Patient {
    private String name;
    private Integer severity;
    private Date checkIn;

    public class Patient( ) {}

    public String getName( ) { return name; }
    public void setName(String name) { this.name = name; }

    public Integer getSeverity( ) { return severity; }
    public void setSeverity(Integer severity) { this.severity = severity; }

    public Date getCheckIn( ) { return checkIn; }
    public void setCheckIn(Date checkIn) { this.checkIn = checkIn; }
}</pre></div>
               </div><br class="example-break"><p>The <code class="literal">PatientPriorityComparator</code>
                                 <a class="indexterm" name="jakartackbk-CHP-5-ITERM-2510"></a>
                                 <a class="indexterm" name="jakartackbk-CHP-5-ITERM-2511"></a>in
                  <a href="jakartackbk-CHP-5-SECT-8.3.html#jakartackbk-CHP-5-EX-6" title="Example&nbsp;5-6.&nbsp;A Comparator to sort Patient objects by priority">Example 5-6</a> prioritizes patients by severity of
                  condition and time since check-in. A patient with a more severe
                  condition takes priority over a patient with a less severe condition
                  who has been waiting longer, and, if two patients have the same
                  severity, the one who has been waiting longer gets a higher priority.
                  If this <code class="literal">Comparator</code> is used to sort an array of
                  <code class="literal">Patient</code> objects, the most critical patient would
                  be at the last index, and the least critical would be at the first
                  index.
               </p>
               <div class="example"><a name="jakartackbk-CHP-5-EX-6"></a><p class="title"><b>Example&nbsp;5-6.&nbsp;A Comparator to sort Patient objects by priority</b></p>
                  <div class="example-contents"><pre class="programlisting">package com.discursive.jccook.collections.buffers;

import java.util.Comparator;

public PatientPriorityComparator implements Comparator {

    public int compare(Object o1, Object o2) {
        int comparison = -1;

        if( o1 instanceof Patient &amp;&amp;
            o2 instanceof Patient ) {

            Patient p1 = (Patient) o1;
            Patient p2 = (Patient) o2;

            comparison = p1.getSeverity( ).compareTo( p2.getSeverity( ) );

                if( comparison == 0 ) {
                    comparison = 
                    p1.getCheckIn( ).compareTo( p2.getCheckIn( ) );
            }
        }
        return comparison;
    }
}</pre></div>
               </div><br class="example-break"><p>When using the <code class="literal">PriorityBuffer</code> with a
                  <code class="literal">PatientPriorityComparator</code>,
                  <code class="literal">Patient</code> objects are added to the <code class="literal">Buffer</code>
                  and <code class="literal">remove( )</code> returns the
                  <code class="literal">Patient</code> with the highest priority. Using a
                  <code class="literal">PriorityBuffer</code> means that you do not need to worry
                  about constantly resorting a <code class="literal">Collection</code> by
                  priority; this logic is completed automatically every time an object
                  is removed from the <code class="literal">Buffer</code>. In other words, you
                  are delegating responsibility to a <code class="literal">Buffer</code>; it
                  takes care of the sorting and selecting on an as-needed basis.
               </p>
               <p>
                                 <a href="jakartackbk-CHP-5-SECT-8.3.html#jakartackbk-CHP-5-EX-7" title="Example&nbsp;5-7.&nbsp;Using a prioritizing buffer">Example 5-7</a> adds three <code class="literal">Patient</code>
                  objects to a <code class="literal">PriorityBuffer</code>: John Doe 1
                  has an ear ache, John Doe 2 has a broken back, and Jane Doe 3 has a
                  concussion. Both John 2 and Jane 3 have serious conditions, and,
                  since John 2 checked in before Jane 3, John 2 has a higher priority
                  than Jane 3. John 1's condition is not nearly as
                  critical; therefore, his priority is much lower, and he is treated
                  last.
               </p>
               <div class="example"><a name="jakartackbk-CHP-5-EX-7"></a><p class="title"><b>Example&nbsp;5-7.&nbsp;Using a prioritizing buffer</b></p>
                  <div class="example-contents"><pre class="programlisting">package com.discursive.jccook.collections.buffers;

public class WaitingRoomApp {

    public static void main(String[] args) {
        WaitingRoomApp example = new WaitingRoomApp( );
        example.start( );
    }

    public void start( ) {
        Buffer patients = 
            new PriorityBuffer( new PatientPriorityComparator( ) );

        Patient johnDoe1 = new Patient( );
        johnDoe1.setName( "John Doe 1" );
        johnDoe1.setSeverity( new Integer( 7 ) );
        johnDoe1.setCheckIn( new Date( ) );
        patients.add( johnDoe1 );

        Patient johnDoe2 = new Patient( );
        johnDoe2.setName( "John Doe 2" );
        johnDoe2.setSeverity( new Integer( 9 ) );
        johnDoe2.setCheckIn( new Date( ) );
        patients.add( johnDoe2 );

        Patient janeDoe3 = new Patient( );
        janeDoe3.setName( "Jane Doe 3" );
        janeDoe3.setSeverity( new Integer( 9 ) );
        janeDoe3.setCheckIn( new Date( ) );
        patients.add( janeDoe3 );

         while( patients.size( ) &gt; 0 ) {
            Patient patient = (Patient) patients.remove( );
            System.out.println( "Patient: " + patient.getName( ) );
        }
    }
}</pre></div>
               </div><br class="example-break"><p>As each <code class="literal">Patient</code> is treated, the
                  patient's name is printed to the console:
               </p><a name="I_5_tt223"></a><pre class="programlisting">Patient: John Doe 2
Patient: Jane Doe 3
Patient: John Doe 1</pre></div>
            <div class="navfooter">
               <hr>
               <table width="100%" summary="Navigation footer">
                  <tr>
                     <td width="40%" align="left"><a accesskey="p" href="jakartackbk-CHP-5-SECT-8.2.html">Prev</a>&nbsp;
                     </td>
                     <td width="20%" align="center"><a accesskey="h" href="book.html">Home</a></td>
                     <td width="40%" align="right">&nbsp;<a accesskey="n" href="jakartackbk-CHP-5-SECT-8.4.html">Next</a></td>
                  </tr>
                  <tr>
                     <td width="40%" align="left" valign="top">5.8.2.&nbsp;Solution&nbsp;</td>
                     <td width="20%" align="center"><span style="color:white;font-size:90%;"><a href="http://www.sonatype.com/" title="Discursive: Discursive">Sponsored by Discursive
                                                                      </a></span></td>
                     <td width="40%" align="right" valign="top">&nbsp;5.8.4.&nbsp;See Also</td>
                  </tr>
               </table>
            </div><br><center>
                             Copyright 2009. Discursive. All Rights Reserved.
                           
            </center><script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1693297-1");
pageTracker._initData();
pageTracker._setDomainName(".sonatype.com");
pageTracker._trackPageview();
</script><script src="http://loopfuse.net/webrecorder/js/listen.js" type="text/javascript"></script><script type="text/javascript">
  _lf_cid = "LF_5208d25a";
_lf_remora();
</script></div>
      </div>
   </body>
</html>