<html xmlns:fo="http://www.w3.org/1999/XSL/Format">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   
      <title>9.12.2.&nbsp;Solution</title>
      <link rel="stylesheet" href="../css/html.css" type="text/css">
      <meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
      <link rel="start" href="book.html" title="Jakarta Commons Cookbook">
      <link rel="up" href="jakartackbk-CHP-9-SECT-12.html" title="9.12.&nbsp;Accessing XML Documents from a Templating Engine">
      <link rel="prev" href="jakartackbk-CHP-9-SECT-12.html" title="9.12.&nbsp;Accessing XML Documents from a Templating Engine">
      <link rel="next" href="jakartackbk-CHP-9-SECT-12.3.html" title="9.12.3.&nbsp;Discussion">
   </head>
   <body>
      <div id="frame">
         <div id="forbg">
            <div id="user-header">
               <div id="logo"><a href="http://www.discursive.com" title="$"><img src="../images/discursive-logo.png" border="0"></a></div>
               <div id="right-header">
                  <h2>Common Java Cookbook</h2>
                  <h4>Edition: 0.1-SNAPSHOT</h4>
               </div>
               <div style="clear:both;"></div>
               <div id="left-sidebar"></div>
            </div>
            <div class="navheader">
               <table width="100%" summary="Navigation header">
                  <tr>
                     <td width="40%" align="left"><a accesskey="p" href="jakartackbk-CHP-9-SECT-12.html">9.12.&nbsp;Accessing XML Documents from a Templating Engine</a>&nbsp;
                     </td>
                     <td width="20%" align="center"><a accesskey="h" href="book.html">
                           												TOC
                                                                       </a></td>
                     <td width="40%" align="right">&nbsp;<a accesskey="n" href="jakartackbk-CHP-9-SECT-12.3.html">9.12.3.&nbsp;Discussion</a></td>
                  </tr>
               </table>
            </div>
            <div class="sect2" lang="en">
               <div class="titlepage">
                  <div>
                     <div>
                        <h3 class="title"><a name="jakartackbk-CHP-9-SECT-12.2"></a>9.12.2.&nbsp;Solution
                        </h3>
                        <div class="section-icon"></div>
                     </div>
                  </div>
               </div>
               <p>Use FreeMarker and parse an XML document with the
                  <code class="literal">NodeModel</code> class. A <code class="literal">NodeModel</code> is
                  an object that allows access to an XML document as a hierarchy of
                  named elements and attributes from a FreeMarker template.
                  <code class="literal">NodeModel</code> has a <code class="literal">public</code>
                                 <code class="literal">static</code> method <code class="literal">parse( )</code>, which
                  parses an XML document and returns a <code class="literal">NodeModel</code> to
                  be added to your context <code class="literal">Map</code>. The following code
                  parses an XML document and passes a <code class="literal">NodeModel</code> to a
                  template:
               </p><a name="I_9_tt390"></a><pre class="programlisting">import freemarker.template.Configuration;
import freemarker.cache.ClassTemplateLoader;
import freemarker.template.ObjectWrapper;
import freemarker.template.Template;
import freemarker.ext.dom.NodeModel;

// Create a File Object for our XML data
File composers = new File("composers.xml");
NodeModel nodeModel = NodeModel.parse( composers );

Map root = new HashMap( );
root.put("doc", nodeModel); 

// A template is processed with a Map and output is sent to a Writer.
Template template = cfg.getTemplate("composerTable.ftl");
template.process(root, writer);
System.out.println("output: \n" + writer.toString( ));</pre><p>A <code class="literal">File</code> object refers to an XML document, and
                  <code class="literal">NodeModel.parse( )</code> is used to parse this document
                  to a <code class="literal">NodeModel</code> object, which is then placed in the
                  <code class="literal">root</code> 
                                 <code class="literal">Map</code>&#8212;the context with
                  which the FreeMarker template will be merged. The XML document
                  contains information about the lives of great classical composers,
                  and the structure of this document is shown here:
               </p><a name="I_9_tt391"></a><pre class="programlisting">&lt;?xml version="1.0"?&gt;

&lt;composers&gt;
  &lt;composer&gt;
    &lt;name&gt;Bach, Johann Sebastian&lt;/name&gt;
    &lt;born date="3/21/1685"&gt;
      &lt;location&gt;Eisenbach&lt;/location&gt;
    &lt;/born&gt;
    &lt;notes&gt;Bach wrote intense and complex fugues.&lt;/notes&gt;
    &lt;link&gt;http://www.bachfaq.org/&lt;/link&gt;
  &lt;/composer&gt;
  &lt;composer&gt;
    &lt;name&gt;Mozart, Wolfgang Amadeus&lt;/name&gt;
    &lt;born date="1/27/1756"&gt;
      &lt;location&gt;Salzburg&lt;/location&gt;
    &lt;/born&gt;
    &lt;notes&gt;Wrote first symphony at age 8.&lt;/notes&gt;
    &lt;link&gt;http://www.mozartproject.org/&lt;/link&gt;
  &lt;/composer&gt;
  &lt;composer&gt;
    &lt;name&gt;Hendrix, Jimi&lt;/name&gt;
    &lt;born date="11/27/1942"&gt;
      &lt;location&gt;Seattle&lt;/location&gt;
    &lt;/born&gt;
    &lt;notes&gt;Hendrix set his guitar on fire in Monterey&lt;/notes&gt;
    &lt;link&gt;http://www.jimihendrix.com/&lt;/link&gt;
  &lt;/composer&gt;
&lt;/composers&gt;</pre><p>The <code class="literal">NodeModel</code>
                                 <a class="indexterm" name="jakartackbk-CHP-9-ITERM-3005"></a>
                                 <a class="indexterm" name="jakartackbk-CHP-9-ITERM-3006"></a>
                  object is exposed to the template as <code class="literal">doc</code>, and the
                  <code class="literal">#list</code> directive is used to iterate through each
                  <code class="literal">composer</code> element. A reference to a child element
                  <code class="literal">link</code> of the <code class="literal">composer</code> element is
                  <code class="literal">${composer.link}</code>, and a reference to the date
                  attribute of the born element is preceded by
                  <code class="literal">@--${composer.born.@date}</code>. The FreeMarker
                  template, which references elements and attributes through a
                  <code class="literal">NodeModel</code>, is:
               </p><a name="I_9_tt392"></a><pre class="programlisting">&lt;#list doc.composers.composer as composer&gt;
  &lt;p&gt;
    &lt;a href="${composer.link}"&gt;${composer.name}&lt;/a&gt;&lt;br/&gt;
    Born on ${composer.born.@date} in ${composer.born.location}&lt;br/&gt;
    Notes: ${composer.notes}
  &lt;/p&gt;
&lt;/#list&gt;</pre></div>
            <div class="navfooter">
               <hr>
               <table width="100%" summary="Navigation footer">
                  <tr>
                     <td width="40%" align="left"><a accesskey="p" href="jakartackbk-CHP-9-SECT-12.html">Prev</a>&nbsp;
                     </td>
                     <td width="20%" align="center"><a accesskey="h" href="book.html">Home</a></td>
                     <td width="40%" align="right">&nbsp;<a accesskey="n" href="jakartackbk-CHP-9-SECT-12.3.html">Next</a></td>
                  </tr>
                  <tr>
                     <td width="40%" align="left" valign="top">9.12.&nbsp;Accessing XML Documents from a Templating Engine&nbsp;</td>
                     <td width="20%" align="center"><span style="color:white;font-size:90%;"><a href="http://www.sonatype.com/" title="Discursive: Discursive">Sponsored by Discursive
                                                                      </a></span></td>
                     <td width="40%" align="right" valign="top">&nbsp;9.12.3.&nbsp;Discussion</td>
                  </tr>
               </table>
            </div><br><center>
                             Copyright 2009. Discursive. All Rights Reserved.
                           
            </center><script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1693297-1");
pageTracker._initData();
pageTracker._setDomainName(".sonatype.com");
pageTracker._trackPageview();
</script><script src="http://loopfuse.net/webrecorder/js/listen.js" type="text/javascript"></script><script type="text/javascript">
  _lf_cid = "LF_5208d25a";
_lf_remora();
</script></div>
      </div>
   </body>
</html>